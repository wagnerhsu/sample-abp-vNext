{"ast":null,"code":"import { mockMembers } from './mock-members';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"primeng/api\";\nimport * as i2 from \"primeng/breadcrumb\";\nimport * as i3 from \"primeng/organizationchart\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"primeng/button\";\nimport * as i6 from \"primeng/table\";\nimport * as i7 from \"primeng/inputtext\";\nimport * as i8 from \"primeng/avatar\";\nimport * as i9 from \"primeng/dialog\";\nimport * as i10 from \"primeng/autocomplete\";\nimport * as i11 from \"@angular/forms\";\nimport * as i12 from \"primeng/confirmpopup\";\n\nfunction OrganizationUnitsComponent_div_5_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵelementStart(1, \"span\", 16);\n    i0.ɵɵelement(2, \"i\", 17);\n    i0.ɵɵelementStart(3, \"input\", 18);\n    i0.ɵɵlistener(\"input\", function OrganizationUnitsComponent_div_5_ng_template_7_Template_input_input_3_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      i0.ɵɵnextContext();\n\n      const _r2 = i0.ɵɵreference(6);\n\n      return _r2.filterGlobal($event.target.value, \"contains\");\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction OrganizationUnitsComponent_div_5_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"th\", 19);\n    i0.ɵɵtext(2, \"Name \");\n    i0.ɵɵelement(3, \"p-sortIcon\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"th\", 21);\n    i0.ɵɵtext(5, \"Username \");\n    i0.ɵɵelement(6, \"p-sortIcon\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 22);\n    i0.ɵɵtext(8, \"Email \");\n    i0.ɵɵelement(9, \"p-sortIcon\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 23);\n    i0.ɵɵtext(11, \"Phone \");\n    i0.ɵɵelement(12, \"p-sortIcon\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"th\", 24);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction OrganizationUnitsComponent_div_5_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵelement(2, \"p-avatar\", 25);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\", 26);\n    i0.ɵɵelementStart(11, \"i\", 27);\n    i0.ɵɵlistener(\"click\", function OrganizationUnitsComponent_div_5_ng_template_9_Template_i_click_11_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const member_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return ctx_r9.removeMember(member_r8, $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const member_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"label\", member_r8.fullName.substr(0, 1));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", member_r8.fullName, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(member_r8.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(member_r8.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(member_r8.phone);\n  }\n}\n\nconst _c0 = function () {\n  return [\"fullName\", \"username\", \"email\", \"phone\"];\n};\n\nfunction OrganizationUnitsComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵelementStart(1, \"div\", 8);\n    i0.ɵɵelementStart(2, \"h6\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function OrganizationUnitsComponent_div_5_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.newMember();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p-table\", 10, 11);\n    i0.ɵɵtemplate(7, OrganizationUnitsComponent_div_5_ng_template_7_Template, 4, 0, \"ng-template\", 12);\n    i0.ɵɵtemplate(8, OrganizationUnitsComponent_div_5_ng_template_8_Template, 14, 0, \"ng-template\", 13);\n    i0.ɵɵtemplate(9, OrganizationUnitsComponent_div_5_ng_template_9_Template, 12, 5, \"ng-template\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Members of \", ctx_r0.selectedUnit.label, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", ctx_r0.tableData)(\"globalFilterFields\", i0.ɵɵpureFunction0(3, _c0));\n  }\n}\n\nfunction OrganizationUnitsComponent_p_dialog_6_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function OrganizationUnitsComponent_p_dialog_6_ng_template_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return ctx_r14.isDialogVisible = false;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(1, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function OrganizationUnitsComponent_p_dialog_6_ng_template_2_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return ctx_r16.addMember();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c1 = function () {\n  return {\n    maxWidth: \"500px\"\n  };\n};\n\nfunction OrganizationUnitsComponent_p_dialog_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"p-dialog\", 28);\n    i0.ɵɵlistener(\"visibleChange\", function OrganizationUnitsComponent_p_dialog_6_Template_p_dialog_visibleChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.isDialogVisible = $event;\n    });\n    i0.ɵɵelementStart(1, \"p-autoComplete\", 29);\n    i0.ɵɵlistener(\"ngModelChange\", function OrganizationUnitsComponent_p_dialog_6_Template_p_autoComplete_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return ctx_r19.memberAutocompleteData = $event;\n    })(\"completeMethod\", function OrganizationUnitsComponent_p_dialog_6_Template_p_autoComplete_completeMethod_1_listener($event) {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return ctx_r20.filterMember($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(2, OrganizationUnitsComponent_p_dialog_6_ng_template_2_Template, 2, 0, \"ng-template\", 30);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"visible\", ctx_r1.isDialogVisible)(\"modal\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleMap(i0.ɵɵpureFunction0(8, _c1));\n    i0.ɵɵproperty(\"dropdown\", true)(\"ngModel\", ctx_r1.memberAutocompleteData)(\"suggestions\", ctx_r1.filteredMembers)(\"multiple\", true);\n  }\n}\n\nexport let OrganizationUnitsComponent = /*#__PURE__*/(() => {\n  class OrganizationUnitsComponent {\n    constructor(confirmationService) {\n      this.confirmationService = confirmationService;\n      this.organizationUnits = [{\n        label: 'Management',\n        expanded: true,\n        children: [{\n          label: 'Selling',\n          expanded: true,\n          children: [{\n            label: 'Customer Relations'\n          }, {\n            label: 'Marketing'\n          }]\n        }, {\n          label: 'Supporting',\n          expanded: true,\n          children: [{\n            label: 'Buying'\n          }, {\n            label: 'Human Resources'\n          }]\n        }]\n      }];\n      this.members = mockMembers;\n      this.breadcrumbItems = [{\n        icon: 'fas fa-home',\n        url: '/'\n      }, {\n        icon: 'fas fa-wrench mr-1',\n        label: 'Administration'\n      }, {\n        icon: 'fas fa-sitemap mr-1',\n        label: 'Organization Units'\n      }];\n      this.memberAutocompleteData = [];\n      this.filteredMembers = [];\n    }\n\n    get tableData() {\n      return this.members.filter(user => user.parents.indexOf(this.selectedUnit.label) > -1);\n    }\n\n    newMember() {\n      this.memberAutocompleteData = [];\n      this.isDialogVisible = true;\n    }\n\n    filterMember(event) {\n      let filtered = [];\n      let query = event.query;\n      const arr = this.members.filter(m => {\n        const memberFromAnotherOrg = m.parents.indexOf(this.selectedUnit.label) < 0;\n        const isMemberSelected = this.memberAutocompleteData.findIndex(memb => memb.fullName === m.fullName) > -1;\n        return memberFromAnotherOrg && !isMemberSelected;\n      });\n\n      for (let i = 0; i < arr.length; i++) {\n        let member = arr[i];\n\n        if (member.fullName.toLowerCase().indexOf(query.toLowerCase()) == 0) {\n          filtered.push(member);\n        }\n      }\n\n      this.filteredMembers = filtered;\n    }\n\n    addMember() {\n      this.memberAutocompleteData.forEach(newMember => {\n        const index = this.members.findIndex(member => member.fullName === newMember.fullName);\n        this.members[index].parents.push(this.selectedUnit.label);\n      });\n      this.isDialogVisible = false;\n    }\n\n    removeMember(member, event) {\n      this.confirmationService.confirm({\n        target: event.target,\n        message: `Are you sure you want to remove the member ${member.fullName}?`,\n        icon: 'pi pi-exclamation-triangle',\n        accept: () => {\n          const index = this.members.findIndex(m => m.fullName === member.fullName);\n          const parentIndex = this.members[index].parents.findIndex(parent => parent === this.selectedUnit.label);\n          this.members[index].parents.splice(parentIndex, 1);\n        },\n        reject: () => {}\n      });\n    }\n\n  }\n\n  OrganizationUnitsComponent.ɵfac = function OrganizationUnitsComponent_Factory(t) {\n    return new (t || OrganizationUnitsComponent)(i0.ɵɵdirectiveInject(i1.ConfirmationService));\n  };\n\n  OrganizationUnitsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OrganizationUnitsComponent,\n    selectors: [[\"app-organization-units\"]],\n    decls: 8,\n    vars: 5,\n    consts: [[1, \"card\"], [1, \"card-header\"], [3, \"model\"], [1, \"card-body\"], [\"selectionMode\", \"single\", 3, \"value\", \"selection\", \"selectionChange\"], [\"class\", \"p-3\", 4, \"ngIf\"], [\"header\", \"New member\", 3, \"visible\", \"modal\", \"visibleChange\", 4, \"ngIf\"], [1, \"p-3\"], [1, \"d-flex\", \"align-items-center\", \"justify-content-between\", \"mb-2\"], [\"pButton\", \"\", \"type\", \"button\", \"icon\", \"pi pi-plus\", \"label\", \"New member\", 1, \"p-button-rounded\", \"p-button-outlined\", \"p-button-success\", \"p-button-sm\", 3, \"click\"], [3, \"value\", \"globalFilterFields\"], [\"table\", \"\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [1, \"d-flex\", \"justify-content-end\"], [1, \"p-input-icon-left\"], [1, \"pi\", \"pi-search\"], [\"pInputText\", \"\", \"type\", \"text\", \"placeholder\", \"Search keyword\", 3, \"input\"], [\"pSortableColumn\", \"fullName\"], [\"field\", \"code\"], [\"pSortableColumn\", \"username\"], [\"pSortableColumn\", \"email\"], [\"pSortableColumn\", \"phone\"], [2, \"width\", \"80px\"], [\"styleClass\", \"mr-2\", \"shape\", \"circle\", 3, \"label\"], [1, \"text-danger\"], [1, \"fas\", \"fa-trash\", \"text-danger\", \"pointer\", 3, \"click\"], [\"header\", \"New member\", 3, \"visible\", \"modal\", \"visibleChange\"], [\"field\", \"fullName\", \"appendTo\", \"body\", 3, \"dropdown\", \"ngModel\", \"suggestions\", \"multiple\", \"ngModelChange\", \"completeMethod\"], [\"pTemplate\", \"footer\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Cancel\", \"icon\", \"pi pi-times\", 1, \"p-button-text\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Save\", \"icon\", \"pi pi-check\", 1, \"p-button-text\", 3, \"click\"]],\n    template: function OrganizationUnitsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelement(2, \"p-breadcrumb\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"p-organizationChart\", 4);\n        i0.ɵɵlistener(\"selectionChange\", function OrganizationUnitsComponent_Template_p_organizationChart_selectionChange_4_listener($event) {\n          return ctx.selectedUnit = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(5, OrganizationUnitsComponent_div_5_Template, 10, 4, \"div\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(6, OrganizationUnitsComponent_p_dialog_6_Template, 3, 9, \"p-dialog\", 6);\n        i0.ɵɵelement(7, \"p-confirmPopup\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"model\", ctx.breadcrumbItems);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", ctx.organizationUnits)(\"selection\", ctx.selectedUnit);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedUnit);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isDialogVisible);\n      }\n    },\n    directives: [i2.Breadcrumb, i3.OrganizationChart, i4.NgIf, i5.ButtonDirective, i6.Table, i1.PrimeTemplate, i7.InputText, i6.SortableColumn, i6.SortIcon, i8.Avatar, i9.Dialog, i10.AutoComplete, i11.NgControlStatus, i11.NgModel, i12.ConfirmPopup],\n    styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%]{}(()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  {var __webpack_modules__ = ({804: (() => {throw new Error(\\\"Module build failed (from ./node_modules/postcss-loader/dist/cjs.js):nBrowserslistError: Unknown version 91 of androidn    at Function.select (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/browserslist/index.js:1096:17)n    at /Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/browserslist/index.js:314:29n    at Array.reduce (<anonymous>)n    at resolve (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/browserslist/index.js:304:34)n    at browserslist (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/browserslist/index.js:406:21)n    at Browsers.parse (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/autoprefixer/lib/browsers.js:54:12)n    at new Browsers (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/autoprefixer/lib/browsers.js:42:26)n    at loadPrefixes (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/autoprefixer/lib/autoprefixer.js:106:20)n    at Object.prepare (/Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/autoprefixer/lib/autoprefixer.js:120:22)n    at /Users/liangshiweis/codes/abp-samples/PrimengSample/angular/node_modules/postcss/lib/lazy-result.js:149:39\\\");})}); var __webpack_exports__ = {}; __webpack_modules__[804](); resource = __webpack_exports__;})()[_ngcontent-%COMP%]{}\"]\n  });\n  return OrganizationUnitsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}