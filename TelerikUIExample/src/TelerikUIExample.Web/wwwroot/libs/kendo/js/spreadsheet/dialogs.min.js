module.exports=function(e){function t(s){if(a[s])return a[s].exports;var i=a[s]={exports:{},id:s,loaded:!1};return e[s].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}({0:function(e,t,a){a(1662),e.exports=a(1662)},3:function(e,t){e.exports=function(){throw Error("define cannot be used indirect")}},8:function(e,t){e.exports=require("../kendo.validator")},20:function(e,t){e.exports=require("../kendo.core")},1635:function(e,t){e.exports=require("../kendo.binder")},1662:function(e,t,a){var s,i,n;!function(l,define){i=[a(20),a(1635),a(8)],s=l,n="function"==typeof s?s.apply(t,i):s,!(void 0!==n&&(e.exports=n))}(function(){!function(e){function t(t,a){return e.spreadsheet.formatting.text(t,a)}function a(e,t){var a,s=[],i=[];for(a=0;a<t.length;a++)E.inArray(t[a][e],i)==-1&&(s.push(t[a]),i.push(t[a][e]));return s}function s(e){return{value:e,text:l("exportAsDialog.pdf.paper."+e)}}function i(t,a){e.spreadsheet.dialogs.register(t,u.extend({options:{messageId:a}}))}function n(e,t){this.path=e.split("."),this.def=t}function l(e,t){return new n(e,t)}function o(e){return e instanceof n?e.trans():Array.isArray(e)?e.map(o):null!=e&&"object"==typeof e?Object.keys(e).reduce(function(t,a){return t[a]=o(e[a]),t},{}):e}var r,d,c,u,p,m,b,g,h,v,k,f,x,y,D,w,C,T,M,F,A,S,_,E=e.jQuery,z=e.data.ObservableObject,B=e.spreadsheet.messages.dialogs={apply:"Apply",save:"Save",cancel:"Cancel",remove:"Remove",retry:"Retry",revert:"Revert",okText:"OK",formatCellsDialog:{title:"Format",categories:{number:"Number",currency:"Currency",date:"Date"}},fontFamilyDialog:{title:"Font"},fontSizeDialog:{title:"Font size"},bordersDialog:{title:"Borders"},alignmentDialog:{title:"Alignment",buttons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"}},mergeDialog:{title:"Merge cells",buttons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"}},freezeDialog:{title:"Freeze panes",buttons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"}},confirmationDialog:{text:"Are you sure you want to remove this sheet?",title:"Sheet remove"},validationDialog:{title:"Data Validation",hintMessage:"Please enter a valid {0} value {1}.",hintTitle:"Validation {0}",criteria:{any:"Any value",number:"Number",text:"Text",date:"Date",custom:"Custom Formula",list:"List"},comparers:{greaterThan:"greater than",lessThan:"less than",between:"between",notBetween:"not between",equalTo:"equal to",notEqualTo:"not equal to",greaterThanOrEqualTo:"greater than or equal to",lessThanOrEqualTo:"less than or equal to"},comparerMessages:{greaterThan:"greater than {0}",lessThan:"less than {0}",between:"between {0} and {1}",notBetween:"not between {0} and {1}",equalTo:"equal to {0}",notEqualTo:"not equal to {0}",greaterThanOrEqualTo:"greater than or equal to {0}",lessThanOrEqualTo:"less than or equal to {0}",custom:"that satisfies the formula: {0}"},labels:{criteria:"Criteria",comparer:"Comparer",min:"Min",max:"Max",value:"Value",start:"Start",end:"End",onInvalidData:"On invalid data",rejectInput:"Reject input",showWarning:"Show warning",showHint:"Show hint",hintTitle:"Hint title",hintMessage:"Hint message",ignoreBlank:"Ignore blank",showListButton:"Display button to show list",showCalendarButton:"Display button to show calendar"},placeholders:{typeTitle:"Type title",typeMessage:"Type message"}},exportAsDialog:{title:"Export...",defaultFileName:"Workbook",xlsx:{description:"Excel Workbook (.xlsx)"},pdf:{description:"Portable Document Format (.pdf)",area:{workbook:"Entire Workbook",sheet:"Active Sheet",selection:"Selection"},paper:{a2:"A2 (420 mm × 594 mm)",a3:"A3 (297 mm x 420 mm)",a4:"A4 (210 mm x 297 mm)",a5:"A5 (148 mm x 210 mm)",b3:"B3 (353 mm × 500 mm)",b4:"B4 (250 mm x 353 mm)",b5:"B5 (176 mm x 250 mm)",folio:'Folio (8.5" x 13")',legal:'Legal (8.5" x 14")',letter:'Letter (8.5" x 11")',tabloid:'Tabloid (11" x 17")',executive:'Executive (7.25" x 10.5")'},margin:{normal:"Normal",narrow:"Narrow",wide:"Wide"}},labels:{scale:"Scale",fit:"Fit to page",fileName:"File name",saveAsType:"Save as type",exportArea:"Export",paperSize:"Paper size",margins:"Margins",orientation:"Orientation",print:"Print",guidelines:"Guidelines",center:"Center",horizontally:"Horizontally",vertically:"Vertically"}},modifyMergedDialog:{errorMessage:"Cannot change part of a merged cell."},rangeDisabledDialog:{errorMessage:"Destination range contains disabled cells."},intersectsArrayDialog:{errorMessage:"You cannot alter part of an array"},incompatibleRangesDialog:{errorMessage:"Incompatible ranges"},noFillDirectionDialog:{errorMessage:"Cannot determine fill direction"},duplicateSheetNameDialog:{errorMessage:"Duplicate sheet name"},overflowDialog:{errorMessage:"Cannot paste, because the copy area and the paste area are not the same size and shape."},useKeyboardDialog:{title:"Copying and pasting",errorMessage:"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:",labels:{forCopy:"for copy",forCut:"for cut",forPaste:"for paste"}},unsupportedSelectionDialog:{errorMessage:"That action cannot be performed on multiple selection."},linkDialog:{title:"Hyperlink",labels:{text:"Text",url:"Address",removeLink:"Remove link"}},insertCommentDialog:{title:"Insert comment",labels:{comment:"Comment",removeComment:"Remove comment"}},insertImageDialog:{title:"Insert image",info:"Drag an image here, or click to select",typeError:"Please select a JPEG, PNG or GIF image"}},P={};e.spreadsheet.dialogs={register:function(e,t){P[e]=t},registered:function(e){return!!P[e]},create:function(e,t){var a=P[e];if(a)return new a(t)}},r=e.spreadsheet.SpreadsheetDialog=e.Observable.extend({init:function(t){e.Observable.fn.init.call(this,t),this.options=o(E.extend(!0,{},this.options,t)),this.bind(this.events,t)},events:["close","activate"],options:{autoFocus:!0},dialog:function(){if(!this._dialog){var t={autoFocus:!1,scrollable:!1,resizable:!1,modal:!0,visible:!1,width:this.options.width||320,title:this.options.title,open:function(){this.center()},close:this._onDialogClose.bind(this),activate:this._onDialogActivate.bind(this),deactivate:this._onDialogDeactivate.bind(this)};this._dialog=E("<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />").addClass(this.options.className||"").append(e.template(this.options.template)({messages:e.spreadsheet.messages.dialogs||B,ns:e.ns,errors:this.options.errors})).kendoWindow(t).data("kendoWindow")}return this._dialog},_onDialogClose:function(){this.trigger("close",{action:this._action})},_onDialogActivate:function(){this.trigger("activate")},_onDialogDeactivate:function(){this.trigger("deactivate"),this.destroy()},destroy:function(){this._dialog&&(this._dialog.destroy(),this._dialog=null)},open:function(){this.dialog().open(),this.dialog().element.find(".k-button-solid-primary").trigger("focus")},apply:function(){this.close()},close:function(){this._action="close",this.dialog().close()}}),d=e.spreadsheet.FormatCellsViewModel=z.extend({init:function(e){z.fn.init.call(this,e),this.useCategory(this.category)},useCategory:function(e){var t=e&&e.type||"number",a="currency"==t;this.category=e,this.set("showCurrencyFilter",a&&this.currencies.length>1),a?this.currency(this.currencies[0]):this.set("formats",this.allFormats[t+"Formats"]),this.useFirstFormat()},useFirstFormat:function(){this.formats.length&&this.set("format",this.formats[0].value)},currency:function(e){var a,s;return void 0!==e&&(this._currency=e,a=e.value,s=[{currency:a,decimals:!0},{currency:a,decimals:!0,iso:!0},{currency:a,decimals:!1}],s=s.map(function(e){return e=d.convert.currency(e),{value:e,name:t(1e3,e)}}),this.set("formats",s),this.useFirstFormat()),this._currency||this.currencies[0]},categoryFilter:function(e){return void 0!==e&&this.useCategory(e),this.category},preview:function(){var e=this.get("format"),a=this.value||0;return e&&e.length?t(a,e):a}}),d.convert={currency:function(e){function t(e,t){return Array(t+1).join(e)}var a=e.currency,s=a.pattern[1];return e.decimals&&(s=s.replace(/n/g,"n"+a["."]+t("0",a.decimals))),s=e.iso?'"'+a.abbr+'" '+s.replace(/\s*\$\s*/g,""):s.replace(/\$/g,JSON.stringify(a.symbol)),s=s.replace(/n/g,"?")},date:function(e){return/T|Z/.test(e)?"":e.toLowerCase().replace(/tt/g,"AM/PM").replace(/'/g,'"')}},c=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.formatCellsDialog||B,s={title:a.title,categories:[{type:"number",name:a.categories.number},{type:"currency",name:a.categories.currency},{type:"date",name:a.categories.date}]};r.fn.init.call(this,E.extend(s,t)),this._generateFormats()},options:{className:"k-spreadsheet-format-cells",template:"<div class='k-edit-form-container'><div class='k-root-tabs' data-#:ns#role='tabstrip' data-#:ns#text-field='name' data-#:ns#bind='source: categories, value: categoryFilter' data-#:ns#animation='false'></div><div class='k-spreadsheet-preview' data-#:ns#bind='text: preview'></div><script type='text/x-kendo-template' id='format-item-template'>\\#: data.name \\#</script><select data-#:ns#role='dropdownlist' class='k-format-filter' data-#:ns#text-field='description' data-#:ns#value-field='value.name' data-#:ns#bind='visible: showCurrencyFilter, value: currency, source: currencies'></select><ul data-#:ns#role='staticlist' tabindex='0' class='k-list k-reset' data-#:ns#template='format-item-template' data-#:ns#value-primitive='true' data-#:ns#value-field='value' data-#:ns#bind='source: formats, value: format'></ul><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button></div></div>"},_generateFormats:function(){var s,i=this.options;i.currencies||(i.currencies=c.currenciesFrom(e.cultures)),i.numberFormats||(i.numberFormats=[{value:"#.00%",name:"100.00%"},{value:"#%",name:"100%"},{value:"#.00",name:"1024.00"},{value:"#,###.00",name:"1,024.00"}]),i.dateFormats||(s=e.cultures.current.calendars.standard.patterns,i.dateFormats=a("value",E.map(s,function(e){if(e=d.convert.date(e))return{value:e,name:t(34567.7678,e)}})))},open:function(t){var a,s,i=this.options,n=t.value(),l=i.categories.slice(0);this.viewModel=new d({currencies:i.currencies.slice(0),allFormats:{numberFormats:i.numberFormats.slice(0),dateFormats:i.dateFormats.slice(0)},categories:l,format:t.format(),category:n instanceof Date?l[2]:l[0],apply:this.apply.bind(this),close:this.close.bind(this),value:n}),r.fn.open.call(this),a=this.dialog().element,e.bind(a,this.viewModel),s=a.find("select.k-format-filter").data("kendoDropDownList"),i.currencies.length>10&&s.setOptions({filter:"contains"}),a.find(e.roleSelector("staticlist")).parent().addClass("k-list-wrapper")},apply:function(){var e=this.viewModel.format;r.fn.apply.call(this),this.trigger("action",{command:"PropertyChangeCommand",options:{property:"format",value:e}})}}),c.currenciesFrom=function(t){return a("description",E.map(t,function(t,a){var s,i;if(/-/.test(a))return s=t.numberFormat.currency,i=e.format("{0} ({1}, {2})",s.name,s.abbr,s.symbol),{description:i,value:s}}))},e.spreadsheet.dialogs.register("formatCells",c),e.spreadsheet.dialogs.FormatCellsDialog=c,u=r.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'><span class='k-button-text'>#= messages.okText #</span></button></div>"},open:function(){var t,a;r.fn.open.call(this),t=this.options,a=t.text,t.messageId&&(a=e.getter(t.messageId,!0)(e.spreadsheet.messages.dialogs)),e.bind(this.dialog().element,{text:a,close:this.close.bind(this)})}}),e.spreadsheet.dialogs.register("message",u),p=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.confirmationDialog||B,s={title:a.title,text:a.text};r.fn.init.call(this,E.extend(s,t))},options:{className:"k-spreadsheet-message",messageId:"",template:"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: confirm'><span class='k-button-text'>#= messages.okText #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button></div>"},open:function(){var t,a;r.fn.open.call(this),t=this.options,a=t.text,t.messageId&&(a=e.getter(t.messageId,!0)(e.spreadsheet.messages.dialogs)),e.bind(this.dialog().element,{text:a,confirm:this.confirm.bind(this),cancel:this.close.bind(this)})},isConfirmed:function(){return this._confirmed},confirm:function(){this._confirmed=!0,this.close()}}),e.spreadsheet.dialogs.register("confirmation",p),m=r.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: retry'><span class='k-button-text'>#= messages.retry #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button></div>"},open:function(){var t,a;r.fn.open.call(this),t=this.options,a=t.text,t.messageId&&(a=e.getter(t.messageId,!0)(e.spreadsheet.messages.dialogs)),e.bind(this.dialog().element,{text:a,retry:this.retry.bind(this),cancel:this.close.bind(this)})},retry:function(){this._retry=!0,this.close()}}),e.spreadsheet.dialogs.register("validationError",m),b=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.fontFamilyDialog||B;r.fn.init.call(this,E.extend({title:a.title},t)),this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var t=this.dialog().element.find("ul"),a=this.options.fonts,s=this.options.defaultFont;this.list=new e.ui.StaticList(t,{dataSource:new e.data.DataSource({data:a}),template:"#: data #",value:s,change:this.apply.bind(this)}),this.list.dataSource.fetch()},apply:function(e){r.fn.apply.call(this),this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontFamily",value:e.sender.value()[0]}})}}),e.spreadsheet.dialogs.register("fontFamily",b),g=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.fontSizeDialog||B;r.fn.init.call(this,E.extend({title:a.title},t)),this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var t=this.dialog().element.find("ul"),a=this.options.sizes,s=this.options.defaultSize;this.list=new e.ui.StaticList(t,{dataSource:new e.data.DataSource({data:a}),template:"#: data #",value:s,change:this.apply.bind(this)}),this.list.dataSource.fetch()},apply:function(t){r.fn.apply.call(this),this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontSize",value:e.parseInt(t.sender.value()[0])}})}}),e.spreadsheet.dialogs.register("fontSize",g),h=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.bordersDialog||B;r.fn.init.call(this,E.extend({title:a.title},t)),this.element=this.dialog().element,this._borderPalette(),this.viewModel=e.observable({apply:this.apply.bind(this),close:this.close.bind(this)}),e.bind(this.element.find(".k-action-buttons"),this.viewModel)},options:{width:177,template:"<div></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button></div>"},apply:function(){r.fn.apply.call(this);var e=this.value();this.trigger("action",{command:"BorderChangeCommand",options:{border:e.type,style:{size:1,color:e.color}}})},_borderPalette:function(){var t=this.dialog().element.find("div").first();this.borderPalette=new e.spreadsheet.BorderPalette(t,{change:this.value.bind(this)})},value:function(e){return void 0===e?this._state:void(this._state=e)}}),e.spreadsheet.dialogs.register("borders",h),v=r.extend({init:function(t){r.fn.init.call(this,t),this.element=this.dialog().element,this.property=t.property,this.options.title=t.title,this.viewModel=e.observable({apply:this.apply.bind(this),close:this.close.bind(this)}),e.bind(this.element.find(".k-action-buttons"),this.viewModel)},options:{template:"<div></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button></div>"},apply:function(){r.fn.apply.call(this),this.trigger("action",{command:"PropertyChangeCommand",options:{property:this.property,value:this.value()}})},value:function(e){return void 0===e?this._value:void(this._value=e.value)}}),k=v.extend({init:function(e){e.width=177,v.fn.init.call(this,e),this._colorPalette()},_colorPalette:function(){var e=this.dialog().element.find("div").first();this.colorPalette=e.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this.value.bind(this)}).data("kendoColorPalette")}}),e.spreadsheet.dialogs.register("colorPicker",k),f=v.extend({init:function(e){e.width=268,v.fn.init.call(this,e),this.dialog().setOptions({animation:!1}),this.dialog().one("activate",this._colorPicker.bind(this))},_colorPicker:function(){var e=this.dialog().element.find("div").first();this.colorPicker=e.kendoFlatColorPicker({change:this.value.bind(this)}).data("kendoFlatColorPicker")}}),e.spreadsheet.dialogs.register("customColor",f),x=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.alignmentDialog||B,s={title:a.title,buttons:[{property:"textAlign",value:"left",iconClass:"align-left",text:a.buttons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"align-center",text:a.buttons.justifyCenter},{property:"textAlign",value:"right",iconClass:"align-right",text:a.buttons.justifyRight},{property:"textAlign",value:"justify",iconClass:"align-justify",text:a.buttons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:a.buttons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:a.buttons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:a.buttons.alignBottom}]};r.fn.init.call(this,E.extend(s,t)),this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var t=this.dialog().element.find("ul");this.list=new e.ui.StaticList(t,{dataSource:new e.data.DataSource({data:this.options.buttons}),template:"<a role='button' title='#=text#' data-property='#=property#' data-value='#=value#'><span class='k-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)}),this.list.dataSource.fetch()},apply:function(e){var t=e.sender.value()[0];r.fn.apply.call(this),this.trigger("action",{command:"PropertyChangeCommand",options:{property:t.property,value:t.value}})}}),e.spreadsheet.dialogs.register("alignment",x),y=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.mergeDialog||B,s={title:a.title,buttons:[{value:"cells",iconClass:"cells-merge",text:a.buttons.mergeCells},{value:"horizontally",iconClass:"cells-merge-horizontally",text:a.buttons.mergeHorizontally},{value:"vertically",iconClass:"cells-merge-vertically",text:a.buttons.mergeVertically},{value:"unmerge",iconClass:"table-unmerge",text:a.buttons.unmerge}]};r.fn.init.call(this,E.extend(s,t)),this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var t=this.dialog().element.find("ul");this.list=new e.ui.StaticList(t,{dataSource:new e.data.DataSource({data:this.options.buttons}),template:"<a role='button' title='#=text#' data-value='#=value#'><span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)}),this.list.dataSource.fetch()},apply:function(e){var t=e.sender.value()[0];r.fn.apply.call(this),this.trigger("action",{command:"MergeCellCommand",options:{value:t.value}})}}),e.spreadsheet.dialogs.register("merge",y),D=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.freezeDialog||B,s={title:a.title,buttons:[{value:"panes",iconClass:"pane-freeze",text:a.buttons.freezePanes},{value:"rows",iconClass:"row-freeze",text:a.buttons.freezeRows},{value:"columns",iconClass:"column-freeze",text:a.buttons.freezeColumns},{value:"unfreeze",iconClass:"table-unmerge",text:a.buttons.unfreeze}]};r.fn.init.call(this,E.extend(s,t)),this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var t=this.dialog().element.find("ul");this.list=new e.ui.StaticList(t,{dataSource:new e.data.DataSource({data:this.options.buttons}),template:"<a role='button' title='#=text#' data-value='#=value#'><span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)}),this.list.dataSource.fetch()},apply:function(e){var t=e.sender.value()[0];r.fn.apply.call(this),this.trigger("action",{command:"FreezePanesCommand",options:{value:t.value}})}}),e.spreadsheet.dialogs.register("freeze",D),w=e.spreadsheet.ValidationCellsViewModel=z.extend({init:function(e){z.fn.init.call(this,e),this.bind("change",function(e){"criterion"===e.field&&(this.reset(),"custom"!==this.criterion&&"list"!==this.criterion||this.setHintMessageTemplate()),"comparer"===e.field&&this.setHintMessageTemplate(),"hintMessage"!=e.field&&"hintTitle"!=e.field||this._mute||(this.shouldBuild=!1),"from"!=e.field&&"to"!=e.field&&"hintMessageTemplate"!=e.field&&"type"!=e.field||!this.shouldBuild||this.buildMessages()}.bind(this)),this.reset()},buildMessages:function(){this._mute=!0,this.set("hintTitle",this.hintTitleTemplate?e.format(this.hintTitleTemplate,this.type):""),this.set("hintMessage",this.hintMessageTemplate?e.format(this.hintMessageTemplate,this.from,this.to):""),this._mute=!1},reset:function(){this.setComparers(),this.set("comparer",this.comparers[0].type),this.set("from",null),this.set("to",null),this.set("useCustomMessages",!1),this.shouldBuild=!0,this.hintTitleTemplate=this.defaultHintTitle,this.buildMessages()},setComparers:function(){var e,t,a=this.defaultComparers,s=[];if("text"===this.criterion)for(e=["equalTo","notEqualTo"],t=0;t<a.length;t++)e[0]==a[t].type&&(s.push(a[t]),e.shift());else s=a.slice();this.set("comparers",s)},setHintMessageTemplate:function(){"custom"!==this.criterion&&"list"!==this.criterion?this.set("hintMessageTemplate",e.format(this.defaultHintMessage,this.criterion,this.comparerMessages[this.comparer])):(this.set("hintMessageTemplate",""),this.set("hintMessage",""))},isAny:function(){return"any"===this.get("criterion")},isNumber:function(){return"number"===this.get("criterion")},showToForNumber:function(){return this.showTo()&&this.isNumber()},showToForDate:function(){return this.showTo()&&this.isDate()},isText:function(){return"text"===this.get("criterion")},isDate:function(){return"date"===this.get("criterion")},isList:function(){return"list"===this.get("criterion")},isCustom:function(){return"custom"===this.get("criterion")},showRemove:function(){return this.get("hasValidation")},showTo:function(){return"between"==this.get("comparer")||"notBetween"==this.get("comparer")},update:function(e){this.set("hasValidation",!!e),e&&this.fromValidationObject(e)},fromValidationObject:function(e){this.set("criterion",e.dataType),this.set("comparer",e.comparerType),this.set("from",e.from),this.set("to",e.to),this.set("type",e.type),this.set("ignoreBlank",e.allowNulls),this.set("showButton",e.showButton),e.messageTemplate||e.titleTemplate?(this.hintMessageTemplate=e.messageTemplate,this.hintMessage=e.messageTemplate,this.hintTitleTemplate=e.titleTemplate,this.hintTitle=e.titleTemplate,this.useCustomMessages=!0,this.buildMessages()):this.useCustomMessages=!1},toValidationObject:function(){if("any"===this.criterion)return null;var e={type:this.type,dataType:this.criterion,comparerType:this.comparer,from:this.from,to:this.to,allowNulls:this.ignoreBlank,showButton:this.showButton};return this.useCustomMessages&&(e.messageTemplate=this.shouldBuild?this.hintMessageTemplate:this.hintMessage,e.titleTemplate=this.hintTitle),e}}),C=r.extend({init:function(t){var a=e.spreadsheet.messages.dialogs.validationDialog||B,s={title:a.title,hintMessage:a.hintMessage,hintTitle:a.hintTitle,criteria:[{type:"any",name:a.criteria.any},{type:"number",name:a.criteria.number},{type:"text",name:a.criteria.text},{type:"date",name:a.criteria.date},{type:"custom",name:a.criteria.custom},{type:"list",name:a.criteria.list}],comparers:[{type:"greaterThan",name:a.comparers.greaterThan},{type:"lessThan",name:a.comparers.lessThan},{type:"between",name:a.comparers.between},{type:"notBetween",name:a.comparers.notBetween},{type:"equalTo",name:a.comparers.equalTo},{type:"notEqualTo",name:a.comparers.notEqualTo},{type:"greaterThanOrEqualTo",name:a.comparers.greaterThanOrEqualTo},{type:"lessThanOrEqualTo",name:a.comparers.lessThanOrEqualTo}],comparerMessages:a.comparerMessages};r.fn.init.call(this,E.extend(s,t))},options:{width:450,criterion:"any",type:"reject",ignoreBlank:!0,showButton:!0,useCustomMessages:!1,errorTemplate:'<div class="k-tooltip k-tooltip-error k-validator-tooltip"><span class="k-tooltip-icon k-icon k-i-warning"></span><span class="k-tooltip-content">#= message #</span><span class="k-callout k-callout-n"></span></div>',template:'<div class="k-edit-form-container"><div class="k-edit-label"><label>#: messages.validationDialog.labels.criteria #:</label></div><div class="k-edit-field"><select data-#:ns#role="dropdownlist" title="#: messages.validationDialog.labels.criteria #"data-#:ns#text-field="name" data-#:ns#value-field="type" data-#:ns#bind="value: criterion, source: criteria"></select></div><div data-#:ns#bind="visible: isNumber"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-#:ns#role="dropdownlist" title="#: messages.validationDialog.labels.comparer #"data-#:ns#text-field="name" data-#:ns#value-field="type" data-#:ns#bind="value: comparer, source: comparers"></select></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.min #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.min #" title="#: messages.validationDialog.labels.min #" placeholder="e.g. 10" class="k-input-inner" data-#:ns#bind="value: from, enabled: isNumber" required="required" /></span></div><div data-#:ns#bind="visible: showTo"><div class="k-edit-label"><label>#: messages.validationDialog.labels.max #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.max #" title="#: messages.validationDialog.labels.max #" placeholder="e.g. 100" class="k-input-inner" data-#:ns#bind="value: to, enabled: showToForNumber" required="required" /></span></div></div></div><div data-#:ns#bind="visible: isText"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-#:ns#role="dropdownlist" title="#: messages.validationDialog.labels.comparer #"data-#:ns#text-field="name" data-#:ns#value-field="type" data-#:ns#bind="value: comparer, source: comparers"></select></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isText" required="required" /></span></div></div><div data-#:ns#bind="visible: isDate"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-#:ns#role="dropdownlist" title="#: messages.validationDialog.labels.comparer #"data-#:ns#text-field="name" data-#:ns#value-field="type" data-#:ns#bind="value: comparer, source: comparers"></select></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.start #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.start #" title="#: messages.validationDialog.labels.start #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isDate" required="required" /></span></div><div data-#:ns#bind="visible: showTo"><div class="k-edit-label"><label>#: messages.validationDialog.labels.end #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.end #" title="#: messages.validationDialog.labels.end #" class="k-input-inner" data-#:ns#bind="value: to, enabled: showToForDate" required="required" /></span></div></div></div><div data-#:ns#bind="visible: isCustom"><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isCustom" required="required" /></span></div></div><div data-#:ns#bind="visible: isList"><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isList" required="required" /></span></div></div><div data-#:ns#bind="visible: isList"><div class="k-edit-field"><input type="checkbox" name="showButton" id="listShowButton" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: showButton"/><label for="listShowButton" class="k-checkbox-label"> #: messages.validationDialog.labels.showListButton #</label></div></div><div data-#:ns#bind="visible: isDate"><div class="k-edit-field"><input type="checkbox" name="showButton" id="dateShowButton" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: showButton"/><label for="dateShowButton" class="k-checkbox-label"> #: messages.validationDialog.labels.showCalendarButton #</label></div></div><div data-#:ns#bind="invisible: isAny"><div class="k-edit-field"><input type="checkbox" title="#: messages.validationDialog.labels.ignoreBlank #" name="ignoreBlank" id="ignoreBlank" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: ignoreBlank"/><label for="ignoreBlank" class="k-checkbox-label"> #: messages.validationDialog.labels.ignoreBlank #</label></div></div><div data-#:ns#bind="invisible: isAny"><div class="k-hr"></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div><div class="k-edit-field"><input type="radio" title="#: messages.validationDialog.labels.rejectInput #" id="validationTypeReject" name="validationType" value="reject" data-#:ns#bind="checked: type" class="k-radio k-radio-md" /><label for="validationTypeReject" class="k-radio-label">#: messages.validationDialog.labels.rejectInput #</label> <input type="radio" title="#: messages.validationDialog.labels.showWarning #" id="validationTypeWarning"  name="validationType" value="warning" data-#:ns#bind="checked: type" class="k-radio k-radio-md" /><label for="validationTypeWarning" class="k-radio-label">#: messages.validationDialog.labels.showWarning #</label></div></div><div data-#:ns#bind="invisible: isAny" class="hint-wrapper"><div class="k-edit-field"><input type="checkbox" title="#: messages.validationDialog.labels.showHint #" name="useCustomMessages" id="useCustomMessages" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: useCustomMessages" /><label class="k-checkbox-label" for="useCustomMessages"> #: messages.validationDialog.labels.showHint #</label></div><div data-#:ns#bind="visible: useCustomMessages"><div class="k-edit-label"><label>#: messages.validationDialog.labels.hintTitle #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input class="k-input-inner" title="#: messages.validationDialog.labels.hintTitle #" placeholder="#: messages.validationDialog.placeholders.typeTitle #" data-#:ns#bind="value: hintTitle" /></span></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.hintMessage #:</label></div><div class="k-edit-field"><span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input class="k-input-inner" title="#: messages.validationDialog.labels.hintMessage #" placeholder="#: messages.validationDialog.placeholders.typeMessage #" data-#:ns#bind="value: hintMessage" /></span></div></div></div><div class="k-action-buttons"><button class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base" data-#:ns#bind="visible: showRemove, click: remove"><span class="k-button-text">#: messages.remove #</span></button><button class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary" data-#:ns#bind="click: apply"><span class="k-button-text">#: messages.apply #</span></button><button class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base" data-#:ns#bind="click: close"><span class="k-button-text">#: messages.cancel #</span></button></div></div>'
},open:function(t){var a,s=this.options;this.viewModel=new w({type:s.type,defaultHintMessage:s.hintMessage,defaultHintTitle:s.hintTitle,defaultComparers:s.comparers.slice(0),comparerMessages:s.comparerMessages,criteria:s.criteria.slice(0),criterion:s.criterion,ignoreBlank:s.ignoreBlank,showButton:s.showButton,apply:this.apply.bind(this),close:this.close.bind(this),remove:this.remove.bind(this)}),this.viewModel.update(t.validation()),r.fn.open.call(this),a=this.dialog().element,this.validatable&&this.validatable.destroy(),e.bind(a,this.viewModel),this.validatable=new e.ui.Validator(a.find(".k-edit-form-container"),{validateOnBlur:!1,errorTemplate:this.options.errorTemplate||void 0})},apply:function(){this.validatable.validate()&&(r.fn.apply.call(this),this.trigger("action",{command:"EditValidationCommand",options:{value:this.viewModel.toValidationObject()}}))},remove:function(){this.viewModel.set("criterion","any"),this.apply()}}),e.spreadsheet.dialogs.register("validation",C),e.spreadsheet.dialogs.ValidationDialog=C,T=r.extend({init:function(t){r.fn.init.call(this,t),t=this.options,this.viewModel=e.observable({title:t.title,name:t.name,extension:t.extension,fileFormats:t.fileFormats,excel:t.excelExport,pdf:{proxyURL:t.pdfExport.proxyURL,forceProxy:t.pdfExport.forceProxy,title:t.pdfExport.title,author:t.pdfExport.author,autoPrint:t.pdfExport.autoPrint,subject:t.pdfExport.subject,keywords:t.pdfExport.keywords,creator:t.pdfExport.creator,date:t.pdfExport.date,fitWidth:t.pdf.fitWidth,area:t.pdf.area,areas:t.pdf.areas,paperSize:t.pdf.paperSize,paperSizes:t.pdf.paperSizes,margin:t.pdf.margin,margins:t.pdf.margins,landscape:t.pdf.landscape,guidelines:t.pdf.guidelines,hCenter:t.pdf.hCenter,vCenter:t.pdf.vCenter},apply:this.apply.bind(this),close:this.close.bind(this)});var a=this.dialog();this.viewModel.bind("change",function(e){"extension"===e.field&&(this.set("showPdfOptions",".pdf"===this.extension),a.center())}),e.bind(a.element,this.viewModel)},options:{title:l("exportAsDialog.title","Export..."),name:l("exportAsDialog.defaultFileName","Workbook"),extension:".xlsx",fileFormats:[{description:l("exportAsDialog.xlsx.description","Excel Workbook (.xlsx)"),extension:".xlsx"},{description:l("exportAsDialog.pdf.description","Portable Document Format (.pdf)"),extension:".pdf"}],pdf:{fitWidth:!0,area:"workbook",areas:[{area:"workbook",text:l("exportAsDialog.pdf.area.workbook","Entire Workbook")},{area:"sheet",text:l("exportAsDialog.pdf.area.sheet","Active Sheet")},{area:"selection",text:l("exportAsDialog.pdf.area.selection","Selection")}],paperSize:"a4",paperSizes:["a2","a3","a4","a5","b3","b4","b5","folio","legal","letter","tabloid","executive"].map(s),margin:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},margins:[{value:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},text:l("exportAsDialog.pdf.margin.normal","Normal")},{value:{bottom:"0.75in",left:"0.25in",right:"0.25in",top:"0.75in"},text:l("exportAsDialog.pdf.margin.narrow","Narrow")},{value:{bottom:"1in",left:"1in",right:"1in",top:"1in"},text:l("exportAsDialog.pdf.margin.wide","Wide")}],landscape:!0,guidelines:!0,hCenter:!0,vCenter:!0},width:520,template:"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.fileName #:</label></div><div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input class='k-input-inner' data-#:ns#bind='value: name' /></span></div><div ><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div><div class='k-edit-field'><select data-#:ns#role='dropdownlist' class='k-file-format' data-#:ns#text-field='description' data-#:ns#value-field='extension' data-#:ns#bind='value: extension, source: fileFormats'></select></div></div><div class='k-export-config' data-#:ns#bind='visible: showPdfOptions'><hr class='k-hr' /><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div><div class='k-edit-field'><select data-#:ns#role='dropdownlist' class='k-file-format' data-#:ns#text-field='text' data-#:ns#value-field='area' data-#:ns#bind='value: pdf.area, source: pdf.areas'></select></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div><div class='k-edit-field'><select data-#:ns#role='dropdownlist' class='k-file-format' data-#:ns#text-field='text' data-#:ns#value-field='value' data-#:ns#bind='value: pdf.paperSize, source: pdf.paperSizes'></select></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.margins #:</label></div><div class='k-edit-field'><select data-#:ns#role='dropdownlist' class='k-file-format' data-#:ns#value-primitive='true'data-#:ns#text-field='text' data-#:ns#value-field='value' data-#:ns#bind='value: pdf.margin, source: pdf.margins'></select></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div><div class='k-edit-field'><div class='k-button-group'><input type='radio' id='k-orientation-portrait' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='false' /><label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'><span class='k-button-icon k-icon k-i-page-portrait'></span></label><input type='radio' id='k-orientation-landscape' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='true' /><label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'><span class='k-button-icon k-icon k-i-page-landscape'></span></label></div></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div><div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-#:ns#bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div><div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-#:ns#bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div><div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-#:ns#bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label><input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-#:ns#bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label></div><div class='k-page-orientation'><span class='k-icon k-i-page-portrait' data-#:ns#bind='invisible: pdf.landscape'></span><span class='k-icon k-i-page-landscape' data-#:ns#bind='visible: pdf.landscape'></span></div></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.save #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button></div>"},apply:function(){r.fn.apply.call(this),this.trigger("action",{command:"SaveAsCommand",options:this.viewModel})}}),e.spreadsheet.dialogs.register("exportAs",T),i("modifyMerged","modifyMergedDialog.errorMessage"),i("rangeDisabled","rangeDisabledDialog.errorMessage"),i("intersectsArray","intersectsArrayDialog.errorMessage"),i("overflow","overflowDialog.errorMessage"),i("unsupportedSelection","unsupportedSelectionDialog.errorMessage"),i("incompatibleRanges","incompatibleRangesDialog.errorMessage"),i("noFillDirection","noFillDirectionDialog.errorMessage"),i("duplicateSheetName","duplicateSheetNameDialog.errorMessage"),M=u.extend({options:{width:640,title:"Errors in import",template:"<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'><div class='k--header-message'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div><div class='k--errors'><table><thead><tr><th>Context</th><th>Error message</th></tr></thead># for (var i = 0; i < errors.length; ++i) { ## var err = errors[i]; #<tr><td>#: err.context #</td><td>#: err.error #</td></tr># } #</table></div></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.okText #</span></button></div>"}}),e.spreadsheet.dialogs.register("importError",M),F=u.extend({options:{title:l("useKeyboardDialog.title","Copying and pasting"),template:"#: messages.useKeyboardDialog.errorMessage #<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div><div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div><div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div><div class=\"k-action-buttons\"><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'><span class='k-button-text'>#= messages.okText #</span></button></div>"}}),e.spreadsheet.dialogs.register("useKeyboard",F),A=r.extend({options:{title:l("linkDialog.title","Hyperlink"),template:"<div class='k-edit-label'><label>#: messages.linkDialog.labels.url #:</label></div><div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input class='k-input-inner' data-#:ns#bind='value: url' title='#: messages.linkDialog.labels.url #' /></span></div><div class='k-action-buttons'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#= messages.linkDialog.labels.removeLink #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#= messages.okText #</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button></div>",autoFocus:!1},open:function(t){var a,s,i=this;r.fn.open.apply(i,arguments),a=i.dialog().element,s=e.observable({url:t.link(),apply:function(){/\S/.test(s.url)||(s.url=null),i.trigger("action",{command:"HyperlinkCommand",options:{link:s.url}}),i.close()},remove:function(){s.url=null,s.apply()},cancel:i.close.bind(i)}),e.bind(a,s),a.find("input").trigger("focus").on("keydown",function(e){13==e.keyCode?(s.url=E(this).val(),e.stopPropagation(),e.preventDefault(),s.apply()):27==e.keyCode&&(e.stopPropagation(),e.preventDefault(),s.cancel())})}}),e.spreadsheet.dialogs.register("hyperlink",A),S=r.extend({options:{className:"k-spreadsheet-insert-comment",template:"\t<div class='k-edit-label'><label>#: messages.insertCommentDialog.labels.comment #:</label></div>\t<div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea rows='5' class='k-input-inner' data-#:ns#bind='value: comment'></textarea></span></div>\t<div class='k-action-buttons'>\t  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#: messages.insertCommentDialog.labels.removeComment #</span></button>\t  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\t  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\t</div>\t",title:l("insertCommentDialog.title","Insert comment"),autoFocus:!1,width:450},open:function(t){var a,s,i=this;r.fn.open.apply(i,arguments),a=i.dialog().element,s=e.observable({comment:t.comment(),apply:function(){/\S/.test(s.comment)||(s.comment=null),i.trigger("action",{command:"InsertCommentCommand",options:{value:s.comment}}),i.close()},remove:function(){s.comment=null,s.apply()},cancel:i.close.bind(i)}),e.bind(a,s),a.find("textarea").trigger("focus")}}),e.spreadsheet.dialogs.register("insertComment",S),_=r.extend({options:{template:"\t<div class='k-spreadsheet-insert-image-dialog'>\t  <label data-#:ns#bind='style: { background-image: imageUrl },\t                    css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered },\t                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\t    <div data-#:ns#bind='text: info'></div>\t    <input type='file' data-#:ns#bind='events: { change: change }'\t           accept='image/png, image/jpeg, image/gif' />\t  </label>\t</div>\t<div class='k-action-buttons'>\t  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='enabled: okEnabled, click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\t  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\t</div>",title:l("insertImageDialog.title","Insert image"),width:"auto"},open:function(){var t,a,s=this;r.fn.open.apply(s,arguments),t=s.dialog().element,a=e.observable({okEnabled:!1,info:e.spreadsheet.messages.dialogs.insertImageDialog.info,imageUrl:"",hasImage:!1,isHovered:!1,_url:null,_image:null,apply:function(){window.URL.revokeObjectURL(a._url),s.trigger("action",{command:"InsertImageCommand",options:{blob:a._image,width:a._width,height:a._height}}),s.close()},cancel:s.close.bind(s),stopEvent:function(e){e.stopPropagation(),e.preventDefault()},drop:function(e){a.stopEvent(e),a.selectFile(e.originalEvent.dataTransfer.files),a.set("isHovered",!1)},dragEnter:function(e){a.stopEvent(e),a.set("isHovered",!0)},dragLeave:function(e){a.stopEvent(e),a.set("isHovered",!1)},change:function(e){a.selectFile(e.target.files)},selectFile:function(t){var s,i,n;for(i=0;i<t.length;++i)if(/^image\//i.test(t[i].type)){s=t[i];break}a._url&&window.URL.revokeObjectURL(a._url),s?(a._image=s,a._url=window.URL.createObjectURL(s),n=new Image,n.src=a._url,n.onload=function(){a._width=n.width,a._height=n.height,a.set("info",e.spreadsheet.messages.dialogs.insertImageDialog.info),a.set("okEnabled",!0),a.set("imageUrl","url('"+a._url+"')"),a.set("hasImage",!0)}):(a._image=null,a.set("info",e.spreadsheet.messages.dialogs.insertImageDialog.typeError),a.set("okEnabled",!1),a.set("imageUrl",""),a.set("hasImage",!1))}}),e.bind(t,a)}}),e.spreadsheet.dialogs.register("insertImage",_),n.prototype.trans=function(){var t,a=e.spreadsheet.messages.dialogs;for(t=0;t<this.path.length;++t)if(a=a[this.path[t]],!a)return this.def;return a}}(window.kendo)},a(3))}});